label_join(
  (
    sum by (integration, entityType, generationType) (rate(process_files_duration_seconds_sum[$__range]))
  /
    sum by (integration, entityType, generationType) (rate(process_files_duration_seconds_count[$__range]))
  ) * 1000000,
  "join_key","|","integration","entityType","generationType"
)
label_join(
  max by (integration, entityType, generationType) (
    clamp_min(idelta(process_files_rows_total[10m]), 0)
  ),
  "join_key","|","integration","entityType","generationType"
)
