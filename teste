String query;

if ("merged".equals(state)) {
    String dateRange = String.format("merged:%sT00:00:00Z..%sT23:59:59Z", since, until);
    query = String.format("is:pr repo:%s/%s author:%s %s",
            orgName, repoName, author, dateRange);
} else {
    String dateRange = String.format("created:%sT00:00:00Z..%sT23:59:59Z", since, until);
    query = String.format("is:pr repo:%s/%s author:%s %s -is:merged",
            orgName, repoName, author, dateRange);
}

HttpHeaders headers = setupHeaders();

URI uri = UriComponentsBuilder
        .fromHttpUrl("https://" + githubOrgProperties.getUrl() + "/search/issues")
        .queryParam("q", query)          // query CRUA (com espa√ßos, :, /, etc.)
        .queryParam("per_page", 1)
        .build()
        .encode()                        // <--- aqui ele faz o encode CERTO
        .toUri();

String url = uri.toString();

log.trace("countPullRequests " + LOG_TRACE_REQUEST_URL_PREFIX, url);

if (author.equals("gabriel-b-batista_bradesco") && repoName.equals("ensc-srv-inner-source-core")) {
    githubRateLimiter.executeWithRateLimit(
            githubRestTemplate,
            url,
            new HttpEntity<>(headers),
            new ParameterizedTypeReference<GitHubSearchIssuesResponse>() {}
    );
}
