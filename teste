helm upgrade --install ms-edi-pix . \
  -f values.qa.yaml \
  -f local-no-crds.yaml \
  --namespace ms-edi-pix \
  --set global.topologySpreadAz=false \
  --set picpay-ms-v2-qa.apis\[0\].affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms=null \
  --set picpay-ms-v2-qa.apis\[1\].affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms=null \
  --set picpay-ms-v2-qa.apis\[2\].affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms=null


kubectl -n ms-edi-pix rollout restart deployment/edi-pix-bankpj deployment/edi-pix-legacy deployment/edi-pix-fnsvcpf
kubectl -n ms-edi-pix get pods -w


helm upgrade --install ms-edi-pix . \
  -f values.qa.yaml \
  -f local-no-crds.yaml \
  --namespace ms-edi-pix \
  --set global.topologySpreadAz=false \
  --set picpay-ms-v2-qa.apis\[0\].affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms=null \
  --set picpay-ms-v2-qa.apis\[1\].affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms=null \
  --set picpay-ms-v2-qa.apis\[2\].affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms=null \
  --set picpay-ms-v2-qa.apis\[0\].image.repositoryURI=nginx --set picpay-ms-v2-qa.apis\[0\].image.tag=stable \
  --set picpay-ms-v2-qa.apis\[1\].image.repositoryURI=nginx --set picpay-ms-v2-qa.apis\[1\].image.tag=stable \
  --set picpay-ms-v2-qa.apis\[2\].image.repositoryURI=nginx --set picpay-ms-v2-qa.apis\[2\].image.tag=stable


P=$(kubectl -n ms-edi-pix get pods -o jsonpath='{.items[0].metadata.name}')
kubectl -n ms-edi-pix describe pod "$P" | sed -n '/Events/,$p'
kubectl -n ms-edi-pix get pod "$P" -o jsonpath='{.spec.nodeSelector}{"\n"}{.spec.tolerations}{"\n"}{range .spec.affinity.*[*]}{.}{end}{"\n"}'
