label_join(
  (
    sum by (integration, entityType, generationType) (rate(process_files_duration_seconds_sum[1h]))
  /
    sum by (integration, entityType, generationType) (rate(process_files_duration_seconds_count[1h]))
  ) * 1000,
  "join_key","|","integration","entityType","generationType"
)

label_join(
  clamp_min(
    sum by (integration, entityType, generationType) (process_files_rows_total)
  - sum by (integration, entityType, generationType) (process_files_rows_total offset 2m),
  0
  ),
  "join_key","|","integration","entityType","generationType"
)

